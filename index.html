<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>法令 条文ビューア</title>
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, sans-serif;
      background: #f3f4f6;
    }

    .app {
      display: flex;
      height: 100vh;
    }

    .pane {
      display: flex;
      flex-direction: column;
      background: white;
    }

    .left {
      width: 50%;
      border-right: 1px solid #ddd;
    }

    .right {
      flex: 1;
    }

    .header {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      background: #fff;
      font-weight: bold;
    }

    .toolbar {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: #e5e7eb;
    }

    input[type="number"] {
      padding: 6px;
      font-size: 16px;
      width: 140px;
    }

    button {
      padding: 6px 14px;
      font-size: 16px;
      cursor: pointer;
    }

    .error {
      color: red;
      font-size: 14px;
    }
  </style>
</head>

<body>
  <div class="app">

    <!-- 左：全文スクロール表示 -->
    <div class="pane left">
      <div class="header">全文表示</div>
      <iframe id="leftViewer"></iframe>
    </div>

    <!-- 右：条文ジャンプ表示 -->
    <div class="pane right">
      <div class="header">条文ジャンプ表示</div>

      <div class="toolbar">
        <input type="file" accept="application/pdf" id="fileInput" />

        <label>条番号:</label>
        <input type="number" id="articleInput" placeholder="例: 11" />

        <button onclick="jumpArticle()">条文ジャンプ</button>

        <span id="error" class="error"></span>
      </div>

      <iframe id="rightViewer"></iframe>
    </div>

  </div>

<script>
let pdfUrl = null;

const fileInput = document.getElementById("fileInput");
const articleInput = document.getElementById("articleInput");
const leftViewer = document.getElementById("leftViewer");
const rightViewer = document.getElementById("rightViewer");
const errorSpan = document.getElementById("error");

// ===== 条番号 → PDFページ対応表（仮） =====
// ※ 実務ではここをJSON化 or 自動生成
// ※ 今は例として一部のみ
const articleToPage = {
  1: 1,
  2: 1,
  3: 2,
  4: 3,
  5: 4,
  6: 5,
  7: 6,
  8: 7,
  9: 8,
  10: 9,
  11: 10,
  12: 11,
  13: 12,
  14: 13,
  15: 14,
  16: 15,
  20: 18,
  25: 22,
  30: 26,
  40: 34,
  42: 36,
  50: 44,
  60: 55,
  70: 70,
  75: 78,
  80: 86,
  82: 88
};

// ===== PDF読み込み =====
fileInput.addEventListener("change", () => {
  const file = fileInput.files[0];
  if (!file) return;

  try {
    errorSpan.textContent = "";

    if (file.type !== "application/pdf") {
      throw new Error("PDFファイルを選択してください");
    }

    pdfUrl = URL.createObjectURL(file);

    leftViewer.src = pdfUrl;
    rightViewer.src = pdfUrl + "#page=1";

  } catch (e) {
    console.error("PDF LOAD ERROR:", e);
    errorSpan.textContent = e.message || "PDF読み込みエラー";
  }
});

// ===== 条文ジャンプ =====
function jumpArticle() {
  if (!pdfUrl) return;

  const article = Number(articleInput.value);

  if (!article || article <= 0) {
    errorSpan.textContent = "正しい条番号を入力してください";
    return;
  }

  const page = articleToPage[article];

  if (!page) {
    errorSpan.textContent = "未登録の条番号です（対応表に未登録）";
    return;
  }

  errorSpan.textContent = "";
  rightViewer.src = pdfUrl + "#page=" + page;
}

</script>

</body>
</html>

<!--
===== テストケース =====

■ PDF表示
1. 正常PDF → 左全文表示・右1ページ目表示
2. PDF以外 → エラー表示

■ 条文ジャンプ
3. 登録済条番号 → 該当ページジャンプ
4. 未登録条番号 → エラー表示
5. 空入力 → エラー表示
6. 0以下 → エラー表示

■ 実機
7. iPad Safari → 表示可
8. GitHub Pages → 表示可

■ 将来拡張
9. articleToPage → JSON外部化
10. PDF自動解析 → 自動生成
-->
